<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wells Fargo Portfolio Management System - Data Model</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #e0e6ed;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin: 0;
            font-weight: 700;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
            margin: 10px 0 0 0;
        }
        
        .erd-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }
        
        .erd-svg {
            width: 100%;
            min-width: 1200px;
            height: 800px;
        }
        
        .entity {
            fill: #3498db;
            stroke: #2980b9;
            stroke-width: 2;
            rx: 10;
            ry: 10;
        }
        
        .entity-title {
            fill: white;
            font-weight: bold;
            font-size: 16px;
            text-anchor: middle;
        }
        
        .attribute {
            fill: #ecf0f1;
            stroke: #bdc3c7;
            stroke-width: 1;
        }
        
        .attribute-text {
            fill: #2c3e50;
            font-size: 12px;
            text-anchor: start;
        }
        
        .primary-key {
            fill: #e74c3c;
            font-weight: bold;
        }
        
        .foreign-key {
            fill: #f39c12;
            font-weight: bold;
        }
        
        .relationship-line {
            stroke: #34495e;
            stroke-width: 2;
            fill: none;
        }
        
        .relationship-text {
            fill: #2c3e50;
            font-size: 12px;
            text-anchor: middle;
            font-weight: bold;
        }
        
        .cardinality {
            fill: #e74c3c;
            font-size: 14px;
            font-weight: bold;
        }
        
        .requirements {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #3498db;
        }
        
        .requirements h3 {
            color: #2c3e50;
            margin-top: 0;
            font-size: 1.4em;
        }
        
        .req-list {
            list-style: none;
            padding: 0;
        }
        
        .req-list li {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative;
            padding-left: 40px;
        }
        
        .req-list li:before {
            content: "âœ“";
            position: absolute;
            left: 15px;
            color: #27ae60;
            font-weight: bold;
            font-size: 16px;
        }
        
        .analysis {
            background: #fff;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
        }
        
        .analysis h3 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 0;
        }
        
        .entity-description {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .entity-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }
        
        .entity-card h4 {
            color: #2c3e50;
            margin-top: 0;
            font-size: 1.2em;
        }
        
        .export-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .export-note h4 {
            color: #856404;
            margin-top: 0;
        }
        
        .download-btn {
            background: #3498db;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: background 0.3s ease;
        }
        
        .download-btn:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Wells Fargo Portfolio Management System</h1>
            <p>Entity Relationship Diagram & Data Model Analysis</p>
        </div>
        
        <div class="requirements">
            <h3>System Requirements Analysis</h3>
            <ul class="req-list">
                <li>The system manages multiple financial advisors and their clients</li>
                <li>Financial advisors can create, update, and remove clients</li>
                <li>Each financial advisor can have numerous clients (1:N relationship)</li>
                <li>Each client has one portfolio (1:1 relationship)</li>
                <li>Client portfolios may contain zero or more securities (1:N relationship)</li>
                <li>Financial advisors can manage securities in client portfolios</li>
                <li>Every security has: name, category, purchase date, purchase price, and quantity</li>
                <li>System uses relational database for data storage</li>
            </ul>
        </div>
        
        <div class="erd-container">
            <svg class="erd-svg" viewBox="0 0 1200 800">
                <!-- Financial Advisor Entity -->
                <rect class="entity" x="50" y="50" width="200" height="180"/>
                <text class="entity-title" x="150" y="75">FINANCIAL_ADVISOR</text>
                
                <!-- Advisor Attributes -->
                <rect class="attribute" x="60" y="90" width="180" height="20"/>
                <text class="attribute-text primary-key" x="65" y="105">advisor_id (PK)</text>
                
                <rect class="attribute" x="60" y="115" width="180" height="20"/>
                <text class="attribute-text" x="65" y="130">first_name</text>
                
                <rect class="attribute" x="60" y="140" width="180" height="20"/>
                <text class="attribute-text" x="65" y="155">last_name</text>
                
                <rect class="attribute" x="60" y="165" width="180" height="20"/>
                <text class="attribute-text" x="65" y="180">email</text>
                
                <rect class="attribute" x="60" y="190" width="180" height="20"/>
                <text class="attribute-text" x="65" y="205">phone</text>
                
                <rect class="attribute" x="60" y="215" width="180" height="20"/>
                <text class="attribute-text" x="65" y="230">hire_date</text>
                
                <!-- Client Entity -->
                <rect class="entity" x="400" y="50" width="200" height="230"/>
                <text class="entity-title" x="500" y="75">CLIENT</text>
                
                <!-- Client Attributes -->
                <rect class="attribute" x="410" y="90" width="180" height="20"/>
                <text class="attribute-text primary-key" x="415" y="105">client_id (PK)</text>
                
                <rect class="attribute" x="410" y="115" width="180" height="20"/>
                <text class="attribute-text foreign-key" x="415" y="130">advisor_id (FK)</text>
                
                <rect class="attribute" x="410" y="140" width="180" height="20"/>
                <text class="attribute-text" x="415" y="155">first_name</text>
                
                <rect class="attribute" x="410" y="165" width="180" height="20"/>
                <text class="attribute-text" x="415" y="180">last_name</text>
                
                <rect class="attribute" x="410" y="190" width="180" height="20"/>
                <text class="attribute-text" x="415" y="205">email</text>
                
                <rect class="attribute" x="410" y="215" width="180" height="20"/>
                <text class="attribute-text" x="415" y="230">phone</text>
                
                <rect class="attribute" x="410" y="240" width="180" height="20"/>
                <text class="attribute-text" x="415" y="255">date_of_birth</text>
                
                <rect class="attribute" x="410" y="265" width="180" height="20"/>
                <text class="attribute-text" x="415" y="280">created_at</text>
                
                <!-- Portfolio Entity -->
                <rect class="entity" x="750" y="50" width="200" height="205"/>
                <text class="entity-title" x="850" y="75">PORTFOLIO</text>
                
                <!-- Portfolio Attributes -->
                <rect class="attribute" x="760" y="90" width="180" height="20"/>
                <text class="attribute-text primary-key" x="765" y="105">portfolio_id (PK)</text>
                
                <rect class="attribute" x="760" y="115" width="180" height="20"/>
                <text class="attribute-text foreign-key" x="765" y="130">client_id (FK)</text>
                
                <rect class="attribute" x="760" y="140" width="180" height="20"/>
                <text class="attribute-text" x="765" y="155">portfolio_name</text>
                
                <rect class="attribute" x="760" y="165" width="180" height="20"/>
                <text class="attribute-text" x="765" y="180">total_value</text>
                
                <rect class="attribute" x="760" y="190" width="180" height="20"/>
                <text class="attribute-text" x="765" y="205">created_at</text>
                
                <rect class="attribute" x="760" y="215" width="180" height="20"/>
                <text class="attribute-text" x="765" y="230">last_updated</text>
                
                <rect class="attribute" x="760" y="240" width="180" height="20"/>
                <text class="attribute-text" x="765" y="255">risk_tolerance</text>
                
                <!-- Security Entity -->
                <rect class="entity" x="400" y="400" width="200" height="255"/>
                <text class="entity-title" x="500" y="425">SECURITY</text>
                
                <!-- Security Attributes -->
                <rect class="attribute" x="410" y="440" width="180" height="20"/>
                <text class="attribute-text primary-key" x="415" y="455">security_id (PK)</text>
                
                <rect class="attribute" x="410" y="465" width="180" height="20"/>
                <text class="attribute-text foreign-key" x="415" y="480">portfolio_id (FK)</text>
                
                <rect class="attribute" x="410" y="490" width="180" height="20"/>
                <text class="attribute-text" x="415" y="505">security_name</text>
                
                <rect class="attribute" x="410" y="515" width="180" height="20"/>
                <text class="attribute-text" x="415" y="530">category</text>
                
                <rect class="attribute" x="410" y="540" width="180" height="20"/>
                <text class="attribute-text" x="415" y="555">purchase_date</text>
                
                <rect class="attribute" x="410" y="565" width="180" height="20"/>
                <text class="attribute-text" x="415" y="580">purchase_price</text>
                
                <rect class="attribute" x="410" y="590" width="180" height="20"/>
                <text class="attribute-text" x="415" y="605">quantity</text>
                
                <rect class="attribute" x="410" y="615" width="180" height="20"/>
                <text class="attribute-text" x="415" y="630">current_price</text>
                
                <rect class="attribute" x="410" y="640" width="180" height="20"/>
                <text class="attribute-text" x="415" y="655">ticker_symbol</text>
                
                <!-- Relationships -->
                
                <!-- Advisor to Client (1:N) -->
                <line class="relationship-line" x1="250" y1="140" x2="400" y2="140"/>
                <text class="cardinality" x="270" y="135">1</text>
                <text class="cardinality" x="380" y="135">N</text>
                <text class="relationship-text" x="325" y="130">manages</text>
                
                <!-- Client to Portfolio (1:1) -->
                <line class="relationship-line" x1="600" y1="140" x2="750" y2="140"/>
                <text class="cardinality" x="620" y="135">1</text>
                <text class="cardinality" x="730" y="135">1</text>
                <text class="relationship-text" x="675" y="130">has</text>
                
                <!-- Portfolio to Security (1:N) -->
                <line class="relationship-line" x1="750" y1="255" x2="500" y2="400"/>
                <text class="cardinality" x="730" y="280">1</text>
                <text class="cardinality" x="520" y="390">N</text>
                <text class="relationship-text" x="625" y="335">contains</text>
                
                <!-- Legend -->
                <rect fill="#f8f9fa" stroke="#dee2e6" x="50" y="700" width="300" height="80" rx="5"/>
                <text class="entity-title" fill="#2c3e50" x="200" y="720">Legend</text>
                <rect class="primary-key" x="60" y="735" width="15" height="12"/>
                <text class="attribute-text" x="80" y="745">Primary Key (PK)</text>
                <rect class="foreign-key" x="60" y="755" width="15" height="12"/>
                <text class="attribute-text" x="80" y="765">Foreign Key (FK)</text>
                
                <text class="attribute-text" x="200" y="745">1 = One</text>
                <text class="attribute-text" x="200" y="765">N = Many</text>
            </svg>
        </div>
        
        <div class="analysis">
            <h3>Entity Analysis & Justification</h3>
            <div class="entity-description">
                <div class="entity-card">
                    <h4>FINANCIAL_ADVISOR</h4>
                    <p>Represents the financial advisors who use the system. Contains essential identification and contact information. The advisor_id serves as the primary key for establishing relationships with clients.</p>
                </div>
                
                <div class="entity-card">
                    <h4>CLIENT</h4>
                    <p>Represents the clients managed by financial advisors. Includes personal information and links to their advisor through advisor_id foreign key. Each client belongs to exactly one advisor but an advisor can have multiple clients.</p>
                </div>
                
                <div class="entity-card">
                    <h4>PORTFOLIO</h4>
                    <p>Represents each client's investment portfolio. Has a 1:1 relationship with CLIENT, meaning each client has exactly one portfolio. Includes portfolio metadata like total value and risk tolerance.</p>
                </div>
                
                <div class="entity-card">
                    <h4>SECURITY</h4>
                    <p>Represents individual securities/investments within portfolios. Satisfies all specified requirements: name, category, purchase date, purchase price, and quantity. Includes additional fields for better portfolio management.</p>
                </div>
            </div>
        </div>
        
        <div class="analysis">
            <h3>Relationship Analysis</h3>
            <div class="entity-description">
                <div class="entity-card">
                    <h4>Advisor â†” Client (1:N)</h4>
                    <p>One financial advisor can manage multiple clients, but each client is assigned to exactly one advisor. This supports the requirement that "each financial advisor can have numerous clients."</p>
                </div>
                
                <div class="entity-card">
                    <h4>Client â†” Portfolio (1:1)</h4>
                    <p>Each client has exactly one portfolio, and each portfolio belongs to exactly one client. This satisfies the requirement that "each client will have a portfolio."</p>
                </div>
                
                <div class="entity-card">
                    <h4>Portfolio â†” Security (1:N)</h4>
                    <p>One portfolio can contain zero or more securities, but each security belongs to exactly one portfolio. This supports the requirement that "client portfolios may contain zero or more securities."</p>
                </div>
            </div>
        </div>
        
        <div class="export-note">
            <h4>Ready for Database Implementation</h4>
            <p>This ERD is designed for relational database implementation and can be directly translated into SQL table schemas. All relationships are properly normalized and follow database design best practices.</p>
            <button class="download-btn" onclick="downloadERD()">Download ERD as PNG</button>
            <button class="download-btn" onclick="generateSQL()">Generate SQL Schema</button>
        </div>
    </div>
    
    <script>
        function downloadERD() {
            // Create a canvas element
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const svg = document.querySelector('.erd-svg');
            
            // Set canvas size
            canvas.width = 1200;
            canvas.height = 800;
            
            // Fill white background
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Convert SVG to image
            const svgData = new XMLSerializer().serializeToString(svg);
            const svgBlob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'});
            const svgUrl = URL.createObjectURL(svgBlob);
            
            const img = new Image();
            img.onload = function() {
                ctx.drawImage(img, 0, 0);
                
                // Create download link
                const link = document.createElement('a');
                link.download = 'wells_fargo_portfolio_erd.png';
                link.href = canvas.toDataURL('image/png');
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                URL.revokeObjectURL(svgUrl);
            };
            img.src = svgUrl;
        }
        
        function generateSQL() {
            const sqlSchema = `
-- Wells Fargo Portfolio Management System
-- Database Schema Generated from ERD

-- Create Financial Advisor table
CREATE TABLE FINANCIAL_ADVISOR (
    advisor_id INT PRIMARY KEY AUTO_INCREMENT,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    phone VARCHAR(20),
    hire_date DATE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- Create Client table
CREATE TABLE CLIENT (
    client_id INT PRIMARY KEY AUTO_INCREMENT,
    advisor_id INT NOT NULL,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    phone VARCHAR(20),
    date_of_birth DATE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (advisor_id) REFERENCES FINANCIAL_ADVISOR(advisor_id) ON DELETE RESTRICT
);

-- Create Portfolio table
CREATE TABLE PORTFOLIO (
    portfolio_id INT PRIMARY KEY AUTO_INCREMENT,
    client_id INT NOT NULL UNIQUE,
    portfolio_name VARCHAR(100) NOT NULL,
    total_value DECIMAL(15,2) DEFAULT 0.00,
    risk_tolerance ENUM('Conservative', 'Moderate', 'Aggressive') DEFAULT 'Moderate',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (client_id) REFERENCES CLIENT(client_id) ON DELETE CASCADE
);

-- Create Security table
CREATE TABLE SECURITY (
    security_id INT PRIMARY KEY AUTO_INCREMENT,
    portfolio_id INT NOT NULL,
    security_name VARCHAR(100) NOT NULL,
    ticker_symbol VARCHAR(10),
    category ENUM('Stock', 'Bond', 'ETF', 'Mutual Fund', 'Option', 'Other') NOT NULL,
    purchase_date DATE NOT NULL,
    purchase_price DECIMAL(10,4) NOT NULL,
    quantity DECIMAL(12,4) NOT NULL,
    current_price DECIMAL(10,4),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (portfolio_id) REFERENCES PORTFOLIO(portfolio_id) ON DELETE CASCADE
);

-- Create indexes for better performance
CREATE INDEX idx_client_advisor ON CLIENT(advisor_id);
CREATE INDEX idx_portfolio_client ON PORTFOLIO(client_id);
CREATE INDEX idx_security_portfolio ON SECURITY(portfolio_id);
CREATE INDEX idx_security_ticker ON SECURITY(ticker_symbol);
CREATE INDEX idx_security_category ON SECURITY(category);
            `.trim();
            
            // Create and download SQL file
            const blob = new Blob([sqlSchema], { type: 'text/sql' });
            const link = document.createElement('a');
            link.download = 'wells_fargo_portfolio_schema.sql';
            link.href = URL.createObjectURL(blob);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
